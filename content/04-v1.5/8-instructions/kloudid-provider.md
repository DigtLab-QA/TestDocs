---
slug: "/post9"
title: "Настройка авторизации через Kloud.ID"
sort: "09"
---

## Настройка провайдера для авторизации через Kloud ID

1. Зарегистрируйтесь и/или авторизуйтесь на сервисе, где развернута система Trusted Net (далее рассматривается сервис [TRUSTED.PLUS](https://id.trusted.plus)).  
2. Создайте провайдер типа OAuth2.0.   
3. Зарегистрируйтесь/авторизуйтесь в сервисе [id.kloud.one](https://id.kloud.one/).
4. Перейдите на вкладку **Приложения**.   
      
   ![kloud-app1](./images/kloud-app1.jpg "Приложения")
   
5.  Нажмите **Добавить**.  
   
      ![kloud-app2](./images/kloud-app2.jpg "Добавление приложения")   

6. Выберите OAUTH 2.
   
      ![kloud-app3](./images/kloud-app3.jpg "Настройки приложения")  

7. Напишите любое название приложения.
 
8.  В поле **Адрес авторизации в приложении (callback) для OAUTH 2** введите URL вида https://id.trusted.plus/idp/sso/authorize.   
**Замените** домен на домен своего сайта.   
        
11. Нажмите **Добавить**.
    
      ![kloud-app4](./images/kloud-app4.jpg "Настройки приложения")  

12. Скопируйте **Идентификатор приложения** и **Секретный ключ**.
    
13. Перейдите в настройки провайдера OAuth2.0 на сервисе Trusted.  
    
    ![kloud-app5](./images/kloud-app5.jpg "Настройки провайдера Trusted")  

14. Вставьте скопированные значения **Идентификатор приложения** и **Секретный ключ** в соответствующие поля в настройках провайдера  и нажмите **Сохранить**.  
    
    ![kloud-app6](./images/kloud-app6.jpg "Настройки авторизации провайдера")  

15. В настройках провайдера установите:   
      - user_authorization_uri — https://id.kloud.one/authorize  
      - access_token_uri — https://id.kloud.one/api/v1/token  
      - user_info_uri — https://id.kloud.one/api/v1/profile  

      **Сохраните** изменения.    
      ![kloud-app7](./images/kloud-app7.jpg "Настройки авторизации провайдера")  
 
16. В настройках провайдера установите флаг **Настройки приватности** как **Публичный**, если хотите, чтобы данный провайдер был доступен всем при настройке авторизации в приложение.  
    
    ![external-provider](./images/external-provider.jpg "Настройки приватности")   


##  Добавление созданного Kloud ID провайдера в приложение
   
1.  Выберите раздел **Мои приложения** в личном кабинете.
   
      ![my-app-menu.png](./images/my-app-menu.png "Мои приложения")

2. В списке приложений выберите приложение, в которое будет добавлена авторизация через Kloud ID провайдер.
   
      ![view-new-app.png](./images/view-new-app.png "Список приложений")

3. В открывшемся окне настроек приложения в разделе **Список провайдеров** нажмите кнопку добавления нового провайдера ![add-provider-btn-to-app](./images/add-provider-btn-to-app.png "Кнопка добавления провайдера"). 
   
      ![add-provider-btn](./images/list-providers.png "Список подключенных провайдеров") 

4. Установите флаг напротив созданного провайдера в списке доступных провайдеров и нажмите кнопку **Сохранить**.
   
      ![select-kloud](./images/select-kloud.jpg "Список доступных провайдеров для добавления в приложение") 

5. Список провайдеров приложения обновится, и в нем отразится добавленный провайдер.

      ![add-ptovider-kloud](./images/add-ptovider-kloud.jpg "Список добавленных в приложение провайдеров")

6. В разделе **Способы авторизации** убедитесь, что переключатель **Провайдеры внешних аккаунтов** включен.

      ![flag-on.png](./images/flag-on.png "Включения флага авторизации через провайдеров внешних аккаунтов")

7. Теперь авторизация в приложение доступна через провайдер Kloud ID.
     
      ![app-login-kloud.png](./images/app-login-kloud.png "Форма авторизации в приложение")

**ИНСТРУКЦИИ ПО ТЕМЕ:**  

1. [Инструкция по созданию приложения.](https://docs.trusted.plus/04-v1.5/8-instructions/create-app)  
2. [Как создать провайдер.](https://docs.trusted.plus/04-v1.5/5-providers/providers)  