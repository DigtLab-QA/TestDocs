---
slug: "/post6"
title: "Настройка авторизации через Mail"
sort: "06"
---

## Настройка провайдера для авторизации через Mail

1. Зарегистрируйтесь и/или авторизуйтесь на сервисе, где развернута система Trusted.Net (далее рассматривается сервис [Trusted.ID](https://id.trusted.plus)).  
2. Создайте провайдер типа OAuth2.0.  
3. Зарегистрируйтесь/авторизуйтесь в [Mail.ru](https://mail.ru/).  
4. Перейдите на страницу добавления приложения https://api.mail.ru/sites/my/add, согласившись с **Правилами использования**.  
       
   ![mail-apps1](./images/mail-apps1.jpg "Информация о сайте")

5. Напишите любое название приложения и URL главной страницы вашего сайта.  
   Нажмите **Продолжить**.

   ![mail-app11](./images/mail-app11.jpg "Информация о сайте")

6. Пропустите следующий шаг по загрузке файла receiver.html.   
7. Скопируйте значения **ID** и **Секретный ключ**.  
   
      ![mail-app12](./images/mail-app12.jpg "Настройки приложения")

8.  Перейдите в настройки провайдера OAuth2.0 на сервисе.  
    
    ![mail-app13](./images/mail-app13.jpg "Настройки провайдера")  

14. Вставьте скопированные значения в соответствующие поля в настройках провайдера  и нажмите **Сохранить**.  
    
    ![mail-app1](./images/mail-app1.jpg "Настройки авторизации провайдера")  

15. В настройках провайдера установите:  
    - user_authorization_uri - https://connect.mail.ru/oauth/authorize  
    - access_token_uri - https://connect.mail.ru/oauth/token  
    - fields - users.getInfo
    - user_info_uri - http://www.appsmail.ru/platform/api     
  
    ![mail-app2](./images/mail-app2.jpg "Настройки авторизации провайдера")
 
	**Сохраните** изменения.  

20. В настройках провайдера установите флаг **Настройки приватности** как **Публичный**, если хотите, чтобы данный провайдер был доступен всем при настройке авторизации в приложение.  
    
     ![external-provider](./images/external-provider.jpg "Настройки приватности")   


##  Добавление созданного Mail провайдера в приложение
   
1.  Выберите раздел **Мои приложения** в личном кабинете.
   
      ![my-app-menu.png](./images/my-app-menu.png "Мои приложения")

2. В списке приложений выберите приложение, в которое будет добавлена авторизация через Mail провайдер.
   
      ![view-new-app.png](./images/view-new-app.png "Список приложений")

3. В открывшемся окне настроек приложения в разделе **Список провайдеров** нажмите кнопку добавления нового провайдера.
    ![add-provider-btn-to-app](./images/add-provider-btn-to-app.png "Кнопка добавления провайдера") 
   
      ![add-provider-btn](./images/list-providers.png "Список подключенных провайдеров") 

4. Установите флаг напротив созданного провайдера в списке доступных провайдеров и нажмите кнопку **Сохранить**.
   
      ![select-mail](./images/select-mail.jpg "Список доступных провайдеров для добавления в приложение") 

5. Список провайдеров приложения обновится, и в нем отразится добавленный провайдер.

      ![add-ptovider-mail](./images/add-ptovider-mail.jpg "Список добавленных в приложение провайдеров")

6. В разделе **Способы авторизации** убедитесь, что переключатель **Провайдеры внешних аккаунтов** включен.

      ![flag-on.png](./images/flag-on.png "Включения флага авторизации через провайдеров внешних аккаунтов")

7. Теперь авторизация в приложение доступна через провайдер Mail.ru.
     
      ![app-login-mail.png](./images/app-login-mail.png "Форма авторизации в приложение")

**ИНСТРУКЦИИ ПО ТЕМЕ:**  

1. [Инструкция по созданию приложения.](https://docs.trusted.plus/03-v1.3/8-instructions/create-app)  
2. [Как создать провайдер.](https://docs.trusted.plus/03-v1.3/5-providers/providers)  