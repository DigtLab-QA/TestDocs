---
slug: "/post2"
title: "Создание LDAP провайдера и подключение в приложение для авторизации через провайдер"
sort: "03"
---

## Создание LDAP провайдера и подключение в приложение для авторизации через провайдер


![ldap-image](./images/ldap-image.png "LDAP")

Провайдер LDAP предназначен для авторизации пользователя через настроенный Active Directory.

***Active Directory*** - служба каталогов корпорации Microsoft, предназначена для хранения и организации объектов сети в иерархическую защищенную логическую структуру, например пользователей, компьютеров или других физических ресурсов. 
Более подробно можно ознакомиться с следующих источниках:
* [Википедия](https://ru.wikipedia.org/wiki/Active_Directory)
* [1cloud](https://1cloud.ru/help/windows/struktura-hranilischa-active-directory)
----

## Предварительные шаги

1. Зарегистрируйтесь и/или авторизуйтесь на сервисе (далее рассматривается сервис [TRUSTED.PLUS](https://id.trusted.plus)).
   
2. Создайте приложение.  
   [Инструкция по созданию приложения.](https://docs.trusted.plus/03-v1.3/8-instructions/create-app)
   
##  Шаг 1. Создание провайдера типа LDAP

1. Выберите раздел **Мои провайдеры** в навигационой панели в личном кабинете.
   
   ![my-provider](./images/my-provider.png "Мои провайдеры")
   
2. Нажмите на кнопку добавление нового провайдера и выберите провайдер **LDAP**.
   
   ![add-provider-btn](./images/add-app-button.png "Кнопка добавления нового провайдера") ![select-prov-button](./images/select-prov-button.png "Список типов провайдеров")

4. В открывшейся форме укажите:
   - название LDAP-провайдера,
   - адрес сервера LDAP (поле ldap_url),
   - контекст учетных записей LDAP (поле ldap_base),
   - имя домена LDAP (поле ldap_domain).

    При необходимости, заполните поля:
    - описание провайдера,
    - адрес профиля пользователя,
    - фильтр поиска учетной записи (поле ldap_filter),
    - список сопоставления атрибутов LDAP (поле ldap_mapping).

5. Нажмите кнопку **Создать**.

    ![create-provider](./images/create-provider.png "LDAP провайдер")
   
5. Провайдер появляется в списке провайдеров:

    ![view-new-provider](./images/view-new-provider.png "Список провайдеров")
----
##  Шаг 2. Добавление созданного LDAP провайдера в приложение
   
1.  Выберите раздел **Мои приложения** в личном кабинете.
   
      ![my-app-menu.png](./images/my-app-menu.png "Мои приложения")

2. В списке приложений выберите приложение, в которое будет добавлена авторизация по LDAP провайдеру.
   
      ![view-new-app.png](./images/view-new-app.png "Список приложений")

3. В открывшемся окне настроек приложения в разделе **Список провайдеров** нажмите кнопку добавления нового провайдера ![add-provider-btn](./images/add-provider-btn-to-app.png "Кнопка добавления провайдера"). 
   
      ![add-provider-btn](./images/list-providers.png "Список подключенных провайдеров") 

4. Установить флаг напротив созданного провайдера в списке доступных провайдеров и нажмите кнопку **Сохранить**.
   
      ![new-provider-in-path-to-access-app](./images/new-provider-in-path-to-access-app.png "Список провайдеров") 

5. Список провайдеров приложения обновиться и в нем отразится добавленный провайдер.

      ![paths-to-access-app](./images/paths-to-access-app.png "Список провайдеров")

6. В разделе **Способы авторизации** убедитесь, что переключатель **Провайдеры внешних аккаунтов** включен.

      ![flag-on.png](./images/flag-on.png "Включения флага авторизации через провайдеров внешних аккаунтов")

7. Теперь авторизация в приложение доступна через LDAP провайдер.
     
      ![app-login.png](./images/app-login.png "Форма авторизации в приложение")

##   Шаг 3. Добавление аккаунта LDAP провайдера в профиль пользователя

Добавить аккаунт LDAP провайдера в профиль пользователя можно несколькими способами:

1. Через личный кабинет в разделе **Мой профиль**, блок **Внешние аккаунты**.
   
2. Через виджет авторизации, используя **Авторизацию  через социальные сети**. Процесс описан в разделе **Регистрация**.
   
3. Через виджет авторизации, используя **Регистрацию через социальные сети**. Процесс описан в разделе **Авторизация**.