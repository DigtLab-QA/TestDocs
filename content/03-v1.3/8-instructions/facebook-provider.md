---
slug: "/post8"
title: "Настройка авторизации через Facebook"
sort: "08"
---

## Настройка провайдера для авторизации через Facebook

1. Зарегистрируйтесь и/или авторизуйтесь на сервисе, где развернута система Trusted Net (далее рассматривается сервис [TRUSTED.PLUS](https://id.trusted.plus)).  
2. Создайте провайдер типа OAuth2.0.   
3. Зарегистрируйтесь/авторизуйтесь в [Facebook](https://www.facebook.com/).  
4. Перейдите на страницу добавления приложения https://developers.facebook.com.   
5. Авторизуйтесь как разработчик.  
6. Выберите тип приложения (Потребительское) и нажмите **Далее**.  
   
   ![fb-app11](./images/fb-app11.jpg "Создание приложения")
   
7.  Напишите любое название и свой email-адрес. Нажмите на **Создание приложения**.  
   
      ![fb-app12](./images/fb-app12.jpg "Название приложения")  

8. В разделе **Товары** - **Добавить товар** выберите **Вход через Facebook** - **Настроить**.
   
   ![fb-app13](./images/fb-app13.jpg "Настройки приложения")  

9.  В мастере настройки перейдите в раздел **Товары** - **Вход через Facebook** → **Настройки**.  

      ![fb-app14](./images/fb-app14.jpg "Настройки приложения")  

10. Включите **Клиентская авторизация OAuth**.  

      ![fb-app16](./images/fb-app16.jpg "Настройки приложения")
 
11. В поле **Действительные URI перенаправления для OAuth** введите URL вида
https://id.trusted.plus/idp/sso/authorize?provider_id=88b3361b2f480ce2&auth_type=OAUTH2,
      где provider_id - это значение поля ProviderId в настройках созданного провайдера OAuth2.0 на сервисе.        
      ![provider](./images/providerid.jpg "ProviderID")  
      
      Замените домен на домен своего сайта.  
      Сохраните изменения.  

11. Перейдите в раздел **Настройки** - **Основное**.  
    
    ![fb-app17](./images/fb-app17.jpg "Основные настройки приложения")  

12. В поле **URL-адрес политики конфиденциальности** введите адрес домена. В поле **Удаление данных пользователей** введите адрес к инструкции по удалению данных.  Сохраните изменения.

      ![fb-app18](./images/fb-app18.jpg "Основные настройки приложения")  
 
11. Cкопируйте **ID приложения** и **Секрет приложения**.
   
12. Перейдите в настройки провайдера OAuth2.0 на сервисе Trusted.  
    
    ![fb-app19](./images/fb-app19.jpg "Настройки провайдера Trusted")  

15. Вставьте скопированные значения **ID приложения** и **Секрет приложения** в соответствующие поля в настройках провайдера  и нажмите **Сохранить**.  
    
    ![fb-app1](./images/fb-app1.jpg "Настройки авторизации провайдера")  

16. В настройках провайдера установите:   
      - user_authorization_uri -https://www.facebook.com/dialog/oauth  
      - scope - email  
      - access_token_uri - https://graph.facebook.com/oauth/access_token  
      - fields - id, email, first_name, last_name, picture.type(large)   
      - user_info_uri - https://graph.facebook.com/me  

      Сохраните изменения.    
      ![fb-app2](./images/fb-app2.jpg "Настройки авторизации провайдера")  
 
13. В настройках провайдера установите флаг **Настройки приватности** как **Публичный**, если хотите, чтобы данный провайдер был доступен всем при настройке авторизации в приложение.  
    
    ![external-provider](./images/external-provider.jpg "Настройки приватности")   


##  Добавление созданного Facebook провайдера в приложение
   
1.  Выберите раздел **Мои приложения** в личном кабинете.
   
      ![my-app-menu.png](./images/my-app-menu.png "Мои приложения")

2. В списке приложений выберите приложение, в которое будет добавлена авторизация через Facebook провайдер.
   
      ![view-new-app.png](./images/view-new-app.png "Список приложений")

3. В открывшемся окне настроек приложения в разделе **Список провайдеров** нажмите кнопку добавления нового провайдера ![add-provider-btn-to-app](./images/add-provider-btn-to-app.png "Кнопка добавления провайдера"). 
   
      ![add-provider-btn](./images/list-providers.png "Список подключенных провайдеров") 

4. Установить флаг напротив созданного провайдера в списке доступных провайдеров и нажмите кнопку **Сохранить**.
   
      ![select-fb](./images/select-fb.jpg "Список доступных провайдеров для добавления в приложение") 

5. Список провайдеров приложения обновиться и в нем отразится добавленный провайдер.

      ![add-ptovider-fb](./images/add-ptovider-fb.jpg "Список добавленных в приложение провайдеров")

6. В разделе **Способы авторизации** убедитесь, что переключатель **Провайдеры внешних аккаунтов** включен.

      ![flag-on.png](./images/flag-on.png "Включения флага авторизации через провайдеров внешних аккаунтов")

7. Теперь авторизация в приложение доступна через провайдер Facebook.
     
      ![app-login-fb.png](./images/app-login-fb.png "Форма авторизации в приложение")

**ИНСТРУКЦИИ ПО ТЕМЕ:**  

1. [Инструкция по созданию приложения.](https://docs.trusted.plus/03-v1.3/8-instructions/create-app)  
2. [Как создать провайдер.](https://docs.trusted.plus/03-v1.3/5-providers/providers)  